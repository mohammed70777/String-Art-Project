<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>String Art Effect</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.js"></script>
</head>
<body>
  <script>
    let img; // متغير لتحميل الصورة
    const numLines = 1000; // عدد الخطوط المرسومة
    const points = []; // نقاط الحدود التي سيستخدمها الرسم

    function preload() {
      // تحميل الصورة المرفوعة
      img = loadImage('image.jpg'); // استبدل الرابط بالصورة المرفوعة
    }

    function setup() {
      createCanvas(800, 800); // إنشاء لوحة الرسم
      img.resize(800, 800); // إعادة تحجيم الصورة
      img.filter(GRAY); // تحويل الصورة إلى الأبيض والأسود
      generateBorderPoints(); // إنشاء نقاط الحدود
      drawStringArt(); // رسم التأثير
    }

    function draw() {
      noLoop(); // توقف الرسم بعد الإطار الأول
    }

    function generateBorderPoints() {
      const steps = 200; // عدد النقاط على الحدود
      for (let i = 0; i < steps; i++) {
        // النقاط العلوية
        points.push({ x: (width / steps) * i, y: 0 });
        // النقاط اليمنى
        points.push({ x: width, y: (height / steps) * i });
        // النقاط السفلية
        points.push({ x: (width / steps) * (steps - i), y: height });
        // النقاط اليسرى
        points.push({ x: 0, y: (height / steps) * (steps - i) });
      }
    }

    function drawStringArt() {
      background(0); // خلفية سوداء
      stroke(255); // لون الخطوط أبيض
      strokeWeight(0.5); // سماكة الخطوط
      noFill();

      let currentPoint = points[0]; // النقطة الابتدائية
      for (let i = 0; i < numLines; i++) {
        let bestPoint;
        let bestValue = 0;

        for (const p of points) {
          const brightnessValue = getBrightnessValue(p.x, p.y);
          if (brightnessValue > bestValue) {
            bestValue = brightnessValue;
            bestPoint = p;
          }
        }

        // رسم خط بين النقطة الحالية وأفضل نقطة
        line(currentPoint.x, currentPoint.y, bestPoint.x, bestPoint.y);

        // تحديث النقطة الحالية
        currentPoint = bestPoint;
      }
    }

    function getBrightnessValue(x, y) {
      // استرجاع السطوع عند نقطة معينة
      const color = img.get(floor(x), floor(y));
      return brightness(color);
    }
  </script>
</body>
</html>
